#include <stdint.h>
static uint64_t seed;
/*

A simplified Openwrt's C rand(), which uses the exact seed value on Openwrt.

This binary is to be called from python exploit after compiling it using:
gcc -shared -fPIC myrand.c -o myrand.so

*/

void mysrand(unsigned s) {
    seed = s-1; }

int myrand(void) {
    seed  = 6364136223846793005ULL*seed + 1;
    return seed>>33; }

int main(void) {
   int r = ((double)myrand() / 2147483647) * (62 - 1 + 1) + 1;
   return r; }
